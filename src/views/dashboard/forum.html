{% extends 'base_dashboard.html' %}

{% block title %}
Forum
{% endblock %}

{% block navtitle %}
Forum
{% endblock %}

{% block body %}

<div class="container">
  <div class="row">
    <div class="offset-5 col-2">
      <h2>Forum</h2>
    </div>
  </div>
  <div class="row">
    <div class="offset-10 col-2">
      <button type="button" class="btn btn-success btn-sm" id="btn-new-category" style="display: none">
        <i class="fas fa-plus"></i> Ajouter une catégorie
      </button>
    </div>
  </div>
  <div class="row justify-content-center" id="forums-wait">
    <i class="fas fa-circle-notch fa-spin fa-2x"></i>
  </div>
  <div class="row justify-content-center" id="noforums" style="display: none">
    <h3>Il n'y a pas encore de forum disponible !</h3>
  </div>
  <div id="forums">
  </div>
</div>

<div id="modal-new-category" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <span class="close">&times;</span>
      <h2>Nouvelle catégorie</h2>
    </div>
    <div class="modal-body">
      <div class="row justify-content-center" style="margin-top: 30px;">
        <form class="form">
          <div class="row">
            <label class="col-4 col-form-label" for="category-name">Nom de la catégorie</label><br>
            <input type="text" class="form-field col-8" name="category-name" id="category-name" placeholder="Ex: Ma catégorie">
          </div>
        </form>
      </div>
    </div>
    <div class="modal-footer d-flex justify-content-end">
      <button type="button" class="btn btn-success btn-sm" id="btn-create-category">
        <i class="fas fa-plus"></i> Ajouter <i id="wait-creating-category" class="fas fa-circle-notch fa-spin" style="display: none"></i>
      </button>
    </div>
  </div>
</div>

{% endblock %}

{% block scripts %}

<script type="text/javascript" src="/scripts/modal.js" ></script>

<script type="text/javascript">
  $(function() {
    var modal = $('#modal-new-category');
    var btn = $('#btn-new-category');
    var user = JSON.parse(localStorage.getItem('user'));

    if (user.role >= 2) {
      btn.show();
    }

    getCategories();

    btn.on("click", function() {
      modal.showModal();
    });
    $('#btn-create-category').on('click', function() {
      createCategory();
    });
  });
</script>

{% endblock %}
